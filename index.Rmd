---
title: "Gov 50 Final Project"
author: "Isabel Smail"
description: "The Influence of Schooling and Hometowns on Political Affiliations"
output:
  distill::distill_article:
    self_contained: false
---


 
## Project thoughts
I am interested to see whether or not education impacts Americans' political affiliations. There are many different types of education in American, for there are many different public, private, vocational, religious, or non-religious schools that students can attend. Access to schooling does play an interesting role, especially in more rural areas where schools and teaching staff might be less concentrated. Socioeconomic aspects also might come into play, for the tutition of private schooling and universities has increased dramatically in the past years. However, I am curious to see if there seems to be some sort of trend. Does the level of school seem to relate to who one votes for? 

```{r}
library(readxl)
EXCEL <- read_excel("~/Desktop/EXCEL.xlsx")
```


##Project Description

Does hometown location and length of schooling affect American political ideologies? In this study, my goal is to analyze the relationship between different types and lengths of schooling and how that can affect American's political affiliations. I am interested to see if the level of schooling (grad school, college, high school grad, or none) will have any correlation with level of progressiveness. I am also curious to see if the location of the schooling plays a role, for public schools' curriculums and budgets differ widely across the United States. I assume that students stemming from more rural areas who experience less schooling will likely lean more conservatively in regards to political affiliations. However, I am unsure as to whether or not there will be a correlation between a specific ideology and those who have experienced extensive schooling (grad schools/PhDs). In this study, the variable profile_educ5 displays the level of schooling of each participant, ranking numerically from lowest to highest with 5 being post-graduate degree. The variable vote20d1 displays the voter's preference for the presidential election - showing political affiliation through their supported candidate. The variables profile_state and profile_region9 both help to specifically describe the voters' location. These variables will help me to analyze the connection between schooling type, location, and poltical affiliations.   

```{r, width = 100}
library(ggplot2)
library(tidyverse)
social_data1 <- EXCEL |> 
  rename(profile_state = ...17, profile_educ5 = ...13, voting = ...98, profile_region9 = ...19)  

social_data1 <- social_data1 |> 
  mutate(profile_educ5 = as.numeric(profile_educ5))

social_data1 <- social_data1 |> 
  mutate(profile_educ_label = case_when(
    profile_educ5 == 1 ~ "Less than HS",
    profile_educ5 == 2 ~ "HS Graduate",
    profile_educ5 == 3 ~ "Vocational/Some College",
    profile_educ5 == 4 ~ "Bachelor's Degree",
    profile_educ5 == 5 ~ "Post Grad Study/Professional Degree")) |>
mutate(region = case_when(
    profile_region9 == 1 ~ "New England",
    profile_region9 == 2 ~ "Mid-Atlantic",
    profile_region9 == 3 ~ "East North Central",
    profile_region9 == 4 ~ "West North Central",
    profile_region9 == 5 ~ "South Atlantic",
    profile_region9 == 6 ~ "East South Central",
    profile_region9 == 7 ~ "West South Central",
    profile_region9 == 8 ~ "Mountain")) |> 
  mutate(voter_pref = case_when(
    voting == -7 ~ "No Response",
    voting == 1 ~ "Trump Supporter",
    voting == 2 ~ "Biden Supporter",
    voting == 3 ~ "Supporter of Someone Else",
    voting == 4 ~ "Doesn't Intend to Vote"))
    

social_graph <- social_data1 |> 
  group_by(region, voter_pref, profile_educ_label) |> 
  summarize(avg_education = mean(profile_educ5, na.rm = TRUE)) |>
  ggplot(mapping = aes(x= voter_pref, y = avg_education, fill = voter_pref)) + geom_col() + facet_wrap(vars(region)) + 
  labs(x = "Voter Choice for 2020 Election", y = "Average Education", title = "Relationship Between Voter Preference and Average Level of Education") + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
social_graph 
``` 
```{r}
count_region <- social_data1 |> 
  mutate(region = case_when(
    profile_region9 == 1 ~ "New England",
    profile_region9 == 2 ~ "Mid-Atlantic",
    profile_region9 == 3 ~ "East North Central",
    profile_region9 == 4 ~ "West North Central",
    profile_region9 == 5 ~ "South Atlantic",
    profile_region9 == 6 ~ "East South Central",
    profile_region9 == 7 ~ "West South Central",
    profile_region9 == 8 ~ "Mountain")) |> 
  group_by(region, voter_pref) |>
  summarize(count = n()) |> 
  ggplot(mapping = aes(x = region, y = count, fill = voter_pref)) + geom_bar(stat = "identity") +
  labs(x = "Region", Y = "Count of Voters", title = "Voter Preference by Region") + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
count_region

```


```{r}
count_education <- social_data1 |> 
  mutate(profile_educ_label = case_when(
    profile_educ5 == 1 ~ "Less than HS",
    profile_educ5 == 2 ~ "HS Graduate",
    profile_educ5 == 3 ~ "Vocational/Some College",
    profile_educ5 == 4 ~ "Bachelor's Degree",
    profile_educ5 == 5 ~ "Post Grad Study/Professional Degree")) |>
  group_by(profile_educ_label, voter_pref) |>
  summarize(count = n()) |> 
  ggplot(mapping = aes(x = profile_educ_label, y = count, fill = voter_pref)) + 
  geom_bar(stat = "identity") +
  labs(x = "Education Level", Y = "Count of Voters", title = "Voter Preference by Education Level") + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
count_education
```

